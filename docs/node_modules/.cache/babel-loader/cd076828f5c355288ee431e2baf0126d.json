{"ast":null,"code":"import _defineProperty from\"/Users/weihung/Documents/workspace/dice/frontend/dice-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/weihung/Documents/workspace/dice/frontend/dice-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/weihung/Documents/workspace/dice/frontend/dice-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/weihung/Documents/workspace/dice/frontend/dice-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/weihung/Documents/workspace/dice/frontend/dice-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/weihung/Documents/workspace/dice/frontend/dice-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/weihung/Documents/workspace/dice/frontend/dice-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React from\"react\";import\"./Endless.css\";import PlayerList from\"./component/PlayerList\";import Controller from\"./component/Controller\";import Countdown from\"./component/Countdown\";import BigText from\"./component/BigText\";import Chart from\"../component/Chart\";import Scatter from\"../eos/Scatter\";var Endless=/*#__PURE__*/function(_React$Component){_inherits(Endless,_React$Component);function Endless(props){var _this;_classCallCheck(this,Endless);_this=_possibleConstructorReturn(this,_getPrototypeOf(Endless).call(this,props));_this.state={disableBet:false,playerList:[],balance:\"0.0000 EOS\",betTimes:0,status:0,stopTime:0,peroid:0,startTime:0,endTime:0,drawData:[1],autoBet:false};_this.bet=0.01;_this.number=1.05;_this.result=0;_this.data=[];_this.alreadyBet=false;_this.handleBet=_this.handleBet.bind(_assertThisInitialized(_this));_this.handleStopBet=_this.handleStopBet.bind(_assertThisInitialized(_this));return _this;}_createClass(Endless,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.interval=setInterval(function(){_this2.getBalance();_this2.getBetList();},1000);this.timeout=setTimeout(function(){_this2.getGameStatus();},1000);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.shouldStop=true;clearInterval(this.interval);clearTimeout(this.timeout);}},{key:\"getBalance\",value:function getBalance(){var _this3=this;Scatter.getBalance(function(result){var r=result[0].split(\" \",1);var amount=parseFloat(r);_this3.setState(_objectSpread({},_this3.state,{balance:result[0]}));if(amount<parseFloat(_this3.bet)){_this3.setState({autoBet:false});}});}},{key:\"getGameStatus\",value:function getGameStatus(){var _this4=this;// let startGame = false;\nScatter.getGameStatus(function(result){try{if(result.length===0||result[0].status===2){// Scatter.newGame(result => {\n//   if (startGame) return;\n//   startGame = true;\n//   this.getGameStatus();\n// });\nreturn;}var status=0;if(Date.now()>result[0].startTime*1000){status=1;if(!_this4.alreadyBet&&_this4.state.autoBet){_this4.alreadyBet=true;Scatter.endlessBet(_this4.bet,_this4.number*100,function(){});}}if(Date.now()>=result[0].openTime*1000){status=3;_this4.alreadyBet=false;}else if(Date.now()>result[0].endTime*1000){status=2;}_this4.setState({startTime:result[0].startTime*1000,endTime:result[0].endTime*1000,peroid:result[0].key,status:status,drawData:[1]});if(status===3){_this4.getGameResult();return;}_this4.timeout=setTimeout(function(){_this4.getGameStatus();},1000);}catch(e){console.log(e);}});}},{key:\"getGameResult\",value:function getGameResult(){var _this5=this;clearTimeout(this.timeout);Scatter.getGameResult(function(result){if(result.length<1||result[0].key!==_this5.state.peroid){/*Scatter.rollDice(() => {\n          this.timeout = setTimeout(() => {\n            this.getGameResult();\n          }, 1000);\n        });*/_this5.timeout=setTimeout(function(){_this5.getGameResult();},1000);return;}_this5.result=result[0].result;_this5.data=[1];_this5.setState({status:4});_this5.startDraw();});}},{key:\"startDraw\",value:function startDraw(){var _this6=this;clearInterval(this.interval);var factory=1.02;var last=this.data[this.data.length-1];last=last*factory;var stop=false;if(last*factory>this.result/100){last=this.result/100;stop=true;// if (this.data.length > 1) this.data = this.data.slice(0, this.data.length - 1)\n}last=last.toFixed(2);this.data.push(parseFloat(last));this.setState({drawData:this.data});if(stop){this.timeout=setTimeout(function(){_this6.getGameStatus();_this6.interval=setInterval(function(){_this6.getBalance();_this6.getBetList();},1000);},5000);return;}this.timeout=setTimeout(function(){_this6.startDraw();},100);}},{key:\"getBetList\",value:function getBetList(){var _this7=this;if(this.state.status===3)return;Scatter.getBetList(function(playerList){_this7.setState({playerList:playerList});});}},{key:\"handleBet\",value:function handleBet(odds,amount,autoBet){this.setState({autoBet:autoBet});this.number=odds;this.bet=amount;this.alreadyBet=true;Scatter.endlessBet(amount,odds*100,function(){});}},{key:\"handleStopBet\",value:function handleStopBet(){this.setState({autoBet:false});}},{key:\"render\",value:function render(){var _this8=this;return React.createElement(\"div\",{className:\"Endless\"},React.createElement(\"div\",{className:\"EndlessLeft\"},React.createElement(\"div\",{className:\"EndlessChart\"},this.state.status===0&&React.createElement(BigText,{value:\"\\u51C6\\u5907\\u4E2D\"}),this.state.status===1&&React.createElement(Countdown,{value:this.state.endTime,peroid:this.state.peroid,onFinish:function onFinish(){_this8.setState({status:2});}}),this.state.status===2&&React.createElement(BigText,{value:\"\\u505C\\u6B62\\u4E0B\\u6CE8\"}),this.state.status===3&&React.createElement(BigText,{value:\"\\u505C\\u6B62\\u4E0B\\u6CE8\"}),this.state.status===4&&React.createElement(Chart,{value:this.state.drawData})),React.createElement(\"div\",{className:\"EndlessController\"},React.createElement(Controller,{disableBet:this.state.status!==1,onBet:this.handleBet,autoBet:this.state.autoBet,stopBet:this.handleStopBet,balance:this.state.balance}))),React.createElement(\"div\",{className:\"EndlessBetList\"},React.createElement(PlayerList,{value:this.state.playerList,result:this.state.drawData[this.state.drawData.length-1]})));}}]);return Endless;}(React.Component);export{Endless as default};","map":{"version":3,"sources":["/Users/weihung/Documents/workspace/dice/frontend/dice-demo/src/endless/Endless.js"],"names":["React","PlayerList","Controller","Countdown","BigText","Chart","Scatter","Endless","props","state","disableBet","playerList","balance","betTimes","status","stopTime","peroid","startTime","endTime","drawData","autoBet","bet","number","result","data","alreadyBet","handleBet","bind","handleStopBet","interval","setInterval","getBalance","getBetList","timeout","setTimeout","getGameStatus","shouldStop","clearInterval","clearTimeout","r","split","amount","parseFloat","setState","length","Date","now","endlessBet","openTime","key","getGameResult","e","console","log","startDraw","factory","last","stop","toFixed","push","odds","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./Endless.css\";\nimport PlayerList from \"./component/PlayerList\";\nimport Controller from \"./component/Controller\";\nimport Countdown from \"./component/Countdown\";\nimport BigText from \"./component/BigText\";\nimport Chart from \"../component/Chart\";\n\nimport Scatter from \"../eos/Scatter\";\n\nexport default class Endless extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      disableBet: false,\n      playerList: [],\n      balance: \"0.0000 EOS\",\n      betTimes: 0,\n      status: 0,\n      stopTime: 0,\n      peroid: 0,\n      startTime: 0,\n      endTime: 0,\n      drawData: [1],\n      autoBet: false,\n    };\n    this.bet = 0.01;\n    this.number = 1.05;\n    this.result = 0;\n    this.data = [];\n    this.alreadyBet = false;\n\n    this.handleBet = this.handleBet.bind(this)\n    this.handleStopBet = this.handleStopBet.bind(this)\n  }\n\n  componentDidMount() {\n    this.interval = setInterval(() => {\n      this.getBalance();\n      this.getBetList();\n    }, 1000);\n    this.timeout = setTimeout(() => {\n      this.getGameStatus();\n    }, 1000);\n  }\n\n  componentWillUnmount() {\n    this.shouldStop = true;\n    clearInterval(this.interval);\n    clearTimeout(this.timeout);\n  }\n\n  getBalance() {\n    Scatter.getBalance(result => {\n      const r = result[0].split(\" \", 1);\n      const amount = parseFloat(r);\n      this.setState({ ...this.state, balance: result[0] });\n      if (amount < parseFloat(this.bet)) {\n        this.setState({autoBet: false});\n      }\n    });\n  }\n\n  getGameStatus() {\n    // let startGame = false;\n    Scatter.getGameStatus(result => {\n      try {\n        if (result.length === 0 || result[0].status === 2) {\n          // Scatter.newGame(result => {\n          //   if (startGame) return;\n          //   startGame = true;\n          //   this.getGameStatus();\n          // });\n          return;\n        }\n        var status = 0;\n        if (Date.now() > result[0].startTime * 1000) {\n          status = 1;\n          if (!this.alreadyBet && this.state.autoBet) {\n            this.alreadyBet = true;\n            Scatter.endlessBet(this.bet, this.number * 100, ()=>{})\n          }\n        }\n        if (Date.now() >= result[0].openTime * 1000) {\n          status = 3;\n          this.alreadyBet = false;\n        } else if (Date.now() > result[0].endTime * 1000) {\n          status = 2;\n        }\n        this.setState({\n          startTime: result[0].startTime * 1000,\n          endTime: result[0].endTime * 1000,\n          peroid: result[0].key,\n          status,\n          drawData: [1]\n        });\n        if (status === 3) {\n          this.getGameResult();\n          return;\n        }\n        this.timeout = setTimeout(() => {\n          this.getGameStatus();\n        }, 1000);\n      } catch (e) {\n        console.log(e);\n      }\n    });\n  }\n\n  getGameResult() {\n    clearTimeout(this.timeout);\n    Scatter.getGameResult(result => {\n      if (result.length < 1 || result[0].key !== this.state.peroid) {\n        /*Scatter.rollDice(() => {\n          this.timeout = setTimeout(() => {\n            this.getGameResult();\n          }, 1000);\n        });*/\n        this.timeout = setTimeout(() => {\n          this.getGameResult();\n        }, 1000);\n        return;\n      }\n      this.result = result[0].result;\n      this.data = [1];\n      this.setState({status:4})\n      this.startDraw();\n    });\n  }\n\n  startDraw() {\n    clearInterval(this.interval);\n    const factory = 1.02;\n    var last = this.data[this.data.length - 1];\n    last = last * factory;\n    var stop = false;\n    if ((last * factory) > this.result / 100) {\n      last = this.result / 100;\n      stop = true;\n      // if (this.data.length > 1) this.data = this.data.slice(0, this.data.length - 1)\n    }\n    last = last.toFixed(2)\n    this.data.push(parseFloat(last));\n    this.setState({ drawData: this.data });\n    if (stop) {\n      this.timeout = setTimeout(() => {\n        this.getGameStatus()\n        this.interval = setInterval(() => {\n          this.getBalance();\n          this.getBetList();\n        }, 1000);\n      }, 5000);\n      \n      return\n    }\n    this.timeout = setTimeout(() => {\n      this.startDraw();\n    }, 100);\n  }\n\n  getBetList(){\n    if (this.state.status === 3) return\n    Scatter.getBetList(playerList=>{\n      this.setState({playerList})\n    })\n  }\n\n  handleBet(odds, amount, autoBet){\n    this.setState({autoBet})\n    this.number = odds\n    this.bet = amount\n    this.alreadyBet = true;\n    Scatter.endlessBet(amount, odds * 100, ()=>{})\n  }\n\n  handleStopBet(){\n    this.setState({autoBet: false});\n  }\n\n  render() {\n    return (\n      <div className=\"Endless\">\n        <div className=\"EndlessLeft\">\n          <div className=\"EndlessChart\">\n            {this.state.status === 0 && <BigText value=\"准备中\" />}\n            {this.state.status === 1 && (\n              <Countdown\n                value={this.state.endTime}\n                peroid={this.state.peroid}\n                onFinish={() => {\n                  this.setState({ status: 2 });\n                }}\n              />\n            )}\n            {this.state.status === 2 && <BigText value=\"停止下注\" />}\n            {this.state.status === 3 && <BigText value=\"停止下注\" />}\n            {this.state.status === 4 && <Chart value={this.state.drawData} />}\n          </div>\n          <div className=\"EndlessController\">\n            <Controller \n              disableBet={this.state.status !== 1} \n              onBet={this.handleBet} \n              autoBet={this.state.autoBet} \n              stopBet={this.handleStopBet} \n              balance={this.state.balance}\n            />\n          </div>\n        </div>\n        <div className=\"EndlessBetList\">\n          <PlayerList value={this.state.playerList} result={this.state.drawData[this.state.drawData.length - 1]}/>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}